<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>6.6. Upgrading from One Stable Distribution to the Next</title><link rel="stylesheet" type="text/css" href="Common_Content/css/default.css" /><link rel="stylesheet" media="print" href="Common_Content/css/print.css" type="text/css" /><meta name="generator" content="publican 3.0" /><meta name="package" content="Debian-debian-handbook-6.0-en-US-1.0-1" /><meta name="keywords" content="apt-get, apt-cache, aptitude, synaptic, sources.list, apt-cdrom" /><link rel="home" href="index.html" title="The Debian Administrator's Handbook" /><link rel="up" href="apt.html" title="Chapter 6. Maintenance and Updates: The APT Tools" /><link rel="prev" href="sect.package-authentication.html" title="6.5. Checking Package Authenticity" /><link rel="next" href="sect.regular-upgrades.html" title="6.7. Keeping a System Up to Date" /></head><body><p class="hidden" id="title"><a class="left" href="http://www.debian.org"><img src="Common_Content/images/image_left.png" alt="Product Site" /></a><a class="right" href="http://debian-handbook.info"><img src="Common_Content/images/image_right.png" alt="Documentation Site" /></a></p><ul class="docnav"><li class="previous"><a accesskey="p" href="sect.package-authentication.html"><strong>Prev</strong></a></li><li class="home">The Debian Administrator's Handbook</li><li class="next"><a accesskey="n" href="sect.regular-upgrades.html"><strong>Next</strong></a></li></ul><div class="section"><div class="titlepage"><div><div><h2 class="title" id="sect.dist-upgrade">6.6. Upgrading from One Stable Distribution to the Next</h2></div></div></div><div class="para"><p></p>
			One of the best-known features of Debian is its ability to upgrade an installed system from one stable release to the next: <span class="foreignphrase"><em class="foreignphrase">dist-upgrade</em></span> — a well-known phrase — has largely contributed to the project's reputation. With a few precautions, upgrading a computer can take as little as a few or a few dozen minutes depending on the download speed from the package repositories.
		</div><div class="section"><div class="titlepage"><div><div><h3 class="title" id="idp13145440">6.6.1. Recommended Procedure</h3></div></div></div><div class="para"><p></p>
				Since Debian has quite some time to evolve in-between stable releases, you should read the release notes before upgrading.
			</div><div class="sidebar"><div class="titlepage"><div><div><h6><span class="emphasis"><em>BACK TO BASICS</em></span> Release notes</h6></div></div></div><div class="para"><p></p>
				The release notes for an operating system (and, more generally, for any software) are a document giving an overview of the software, with some details concerning the particularities of one version. These documents are generally short compared to the complete documentation, and they usually list the features which have been introduced since the previous version. They also give details on upgrading procedures, warnings for users of previous versions, and sometimes errata.
			</div><div class="para"><p></p>
				Release notes are available online: the release notes for the current stable release have a dedicated URL, while older release notes can be found with their codenames: <div xmlns="" class="url">→ <a xmlns="http://www.w3.org/1999/xhtml" href="http://www.debian.org/releases/stable/releasenotes">http://www.debian.org/releases/stable/releasenotes</a></div> <div xmlns="" class="url">→ <a xmlns="http://www.w3.org/1999/xhtml" href="http://www.debian.org/releases/lenny/releasenotes">http://www.debian.org/releases/lenny/releasenotes</a></div>
			</div></div><div class="para"><p></p>
				In this section, we will focus on upgrading a <span class="distribution distribution">Lenny</span> system to <span class="distribution distribution">Squeeze</span>. This is a major operation on a system; as such, it is never 100% risk-free, and should not be attempted before all important data has been backed up.
			</div><div class="para"><p></p>
				Another good habit which makes the upgrade easier (and shorter) is to tidy your installed packages and keep only the ones that are really needed. Helpful tools to do that include <code class="command">aptitude</code>, <code class="command">deborphan</code> and <code class="command">debfoster</code> (see <a class="xref" href="sect.apt-frontends.html#aptitude">Section 6.4.1, “ <code class="command">aptitude</code> ”</a>). For example, you can use the following command:
			</div><pre class="screen"><code class="computeroutput"># </code><strong class="userinput"><code>deborphan | xargs aptitude remove</code></strong></pre><div class="para"><p></p>
				Now for the upgrading itself. First, you need to change the <code class="filename">/etc/apt/sources.list</code> file to tell APT to get its packages from <span class="distribution distribution">Squeeze</span> instead of <span class="distribution distribution">Lenny</span>. If the file only contains references to <span class="distribution distribution">Stable</span> rather than explicit codenames, the change isn't even required, since <span class="distribution distribution">Stable</span> always refers to the latest released version of Debian. In both cases, the database of available packages must be refreshed (with the <code class="command">aptitude update</code> command or the refresh button in <code class="command">synaptic</code>).
			</div><div class="para"><p></p>
				Once these new package sources are registered, you need to upgrade the <span class="pkg pkg">aptitude</span> and <span class="pkg pkg">apt</span> packages; their versions in <span class="distribution distribution">Lenny</span> have some limitations that could compromise the automatic upgrade.
			</div><div class="para"><p></p>
				Remember to upgrade (or install) the most essential packages listed below, otherwise you might find that your system is unbootable:
			</div><div class="itemizedlist"><ul><li class="listitem"><div class="para"><p></p>
						the bootloader <span class="pkg pkg">grub-pc</span> or <span class="pkg pkg">grub-legacy</span> (sometimes <span class="pkg pkg">lilo</span>);
					</div></li><li class="listitem"><div class="para"><p></p>
						the tools that build the initial ramdisk (initrd): <span class="pkg pkg">initramfs-tools</span>;
					</div></li><li class="listitem"><div class="para"><p></p>
						the standard library: <span class="pkg pkg">libc6</span> or one of its optimized variants such as <span class="pkg pkg">libc6-i686</span>;
					</div></li><li class="listitem"><div class="para"><p></p>
						the management system for device files: <span class="pkg pkg">udev</span>;
					</div></li><li class="listitem"><div class="para"><p></p>
						last but not least, the kernel: depending on the hardware, the metapackages to use are <span class="pkg pkg">linux-image-486</span>, <span class="pkg pkg">linux-image-686</span> or <span class="pkg pkg">linux-image-686-bigmem</span>. These packages will only work for the i386 architecture; owners of computers based on different hardware will use other packages, most likely <span class="pkg pkg">linux-image-2.6-amd64</span> for AMD64 or <span class="pkg pkg">linux-image-powerpc*</span> for PowerPC).
					</div></li></ul></div><div class="para"><p></p>
				Once these first steps are done, it is time to handle the upgrade itself, either with <code class="command">aptitude</code> or <code class="command">synaptic</code>. You should carefully check the suggested actions before applying them: you might want to add suggested packages or deselect packages which are only recommended and known not to be useful. In any case, the front-end should come up with a scenario ending in a coherent and up-to-date <span class="distribution distribution">Squeeze</span> system. Then, all you need is to do is wait while the required packages are downloaded, answer the Debconf questions and possibly those about locally modified configuration files, and sit back while APT does its magic.
			</div></div><div class="section"><div class="titlepage"><div><div><h3 class="title" id="idp13166056">6.6.2. Handling Problems after an Upgrade</h3></div></div></div><div class="para"><p></p>
				In spite of the Debian maintainers' best efforts, a major system upgrade isn't always as smooth as you could wish. New software versions may be incompatible with previous ones (for instance, their default behavior or their data format may have changed). Also, some bugs may slip through the cracks despite the testing phase which always precedes a Debian release.
			</div><div class="para"><p></p>
				To anticipate some of these problems, you can install the <span class="pkg pkg">apt-listchanges</span> package, which displays information about possible problems at the beginning of a package upgrade. This information is compiled by the package maintainers and put in <code class="filename">/usr/share/doc/<em class="replaceable"><code>package</code></em>/NEWS.Debian</code> files for the benefit of users. Reading these files (possibly through <span class="pkg pkg">apt-listchanges</span>) should help you avoid bad surprises.
			</div><div class="para"><p></p>
				You might sometimes find that the new version of a software doesn't work at all. This generally happens if the application isn't particularly popular and hasn't been tested enough; a last-minute update can also introduce regressions which are only found after the stable release. In both cases, the first thing to do is to have a look at the bug tracking system at <code class="literal">http://bugs.debian.org/<em class="replaceable"><code>package</code></em></code>, and check whether the problem has already been reported. If it hasn't, you should report it yourself with <code class="command">reportbug</code>. If it is already known, the bug report and the associated messages are usually an excellent source of information related to the bug:
			</div><div class="itemizedlist"><ul><li class="listitem"><div class="para"><p></p>
						sometimes a patch already exists, and it is available on the bug report; you can then recompile a fixed version of the broken package locally (see <a class="xref" href="debian-packaging.html#sect.rebuilding-package">Section 15.1, “Rebuilding a Package from its Sources”</a>);
					</div></li><li class="listitem"><div class="para"><p></p>
						in other cases, users may have found a workaround for the problem and shared their insights about it in their replies to the report;
					</div></li><li class="listitem"><div class="para"><p></p>
						in yet other cases, a fixed package may have already been prepared and made public by the maintainer.
					</div></li></ul></div><div class="para"><p></p>
				Depending on the severity of the bug, a new version of the package may be prepared specifically for a new revision of the stable release. When this happens, the fixed package is made available in the <code class="literal">proposed-updates</code> section of the Debian mirrors (see <a class="xref" href="apt.html#section.proposed-updates">Section 6.1.1.1, “<span class="distribution distribution">Stable</span> Updates”</a>). The corresponding entry can then be temporarily added to the <code class="filename">sources.list</code> file, and updated packages can be installed with <code class="command">apt-get</code> or <code class="command">aptitude</code>.
			</div><div class="para"><p></p>
				Sometimes the fixed package isn't available in this section yet because it is pending a validation by the Stable Release Managers. You can verify if that's the case on their web page. Packages listed there aren't available yet, but at least you know that the publication process is ongoing. <div xmlns="" class="url">→ <a xmlns="http://www.w3.org/1999/xhtml" href="http://release.debian.org/proposed-updates/stable.html">http://release.debian.org/proposed-updates/stable.html</a></div>
			</div></div></div><div id="site_footer"></div><script type="text/javascript">
		$("#site_footer").load("../../../../../footer.html");
	</script><ul class="docnav"><li class="previous"><a accesskey="p" href="sect.package-authentication.html"><strong>Prev</strong>6.5. Checking Package Authenticity</a></li><li class="up"><a accesskey="u" href="#"><strong>Up</strong></a></li><li class="home"><a accesskey="h" href="index.html"><strong>Home</strong></a></li><li class="next"><a accesskey="n" href="sect.regular-upgrades.html"><strong>Next</strong>6.7. Keeping a System Up to Date</a></li></ul></body></html>
