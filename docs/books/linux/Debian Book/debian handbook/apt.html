<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Chapter 6. Maintenance and Updates: The APT Tools</title><link rel="stylesheet" type="text/css" href="Common_Content/css/default.css" /><link rel="stylesheet" media="print" href="Common_Content/css/print.css" type="text/css" /><meta name="generator" content="publican 3.0" /><meta name="package" content="Debian-debian-handbook-6.0-en-US-1.0-1" /><meta name="keywords" content="apt-get, apt-cache, aptitude, synaptic, sources.list, apt-cdrom" /><link rel="home" href="index.html" title="The Debian Administrator's Handbook" /><link rel="up" href="index.html" title="The Debian Administrator's Handbook" /><link rel="prev" href="sect.coexistence-with-other-packaging-systems.html" title="5.5. Coexistence with Other Packaging Systems" /><link rel="next" href="sect.apt-get.html" title="6.2. aptitude and apt-get Commands" /></head><body><p class="hidden" id="title"><a class="left" href="http://www.debian.org"><img src="Common_Content/images/image_left.png" alt="Product Site" /></a><a class="right" href="http://debian-handbook.info"><img src="Common_Content/images/image_right.png" alt="Documentation Site" /></a></p><ul class="docnav"><li class="previous"><a accesskey="p" href="sect.coexistence-with-other-packaging-systems.html"><strong>Prev</strong></a></li><li class="home">The Debian Administrator's Handbook</li><li class="next"><a accesskey="n" href="sect.apt-get.html"><strong>Next</strong></a></li></ul><div class="chapter" id="apt"><div class="titlepage"><div><div><h2 class="title">Chapter 6. Maintenance and Updates: The APT Tools</h2></div></div></div><div class="toc"><dl><dt><span class="section"><a href="apt.html#sect.apt-sources.list">6.1. Filling in the <code class="filename">sources.list</code> File</a></span></dt><dd><dl><dt><span class="section"><a href="apt.html#idp12866472">6.1.1. Other Available Official Repositories</a></span></dt><dt><span class="section"><a href="apt.html#section.ressources-non-off">6.1.2. Non-Official Resources: <code class="literal">apt-get.org</code> and <code class="literal">mentors.debian.net</code></a></span></dt></dl></dd><dt><span class="section"><a href="sect.apt-get.html">6.2. <code class="command">aptitude</code> and <code class="command">apt-get</code> Commands</a></span></dt><dd><dl><dt><span class="section"><a href="sect.apt-get.html#idp13287264">6.2.1. Initialization</a></span></dt><dt><span class="section"><a href="sect.apt-get.html#idp13290624">6.2.2. Installing and Removing</a></span></dt><dt><span class="section"><a href="sect.apt-get.html#section.apt-mise-a-jour">6.2.3. System Upgrade</a></span></dt><dt><span class="section"><a href="sect.apt-get.html#idp13343776">6.2.4. Configuration Options</a></span></dt><dt><span class="section"><a href="sect.apt-get.html#idp13356304">6.2.5. Managing Package Priorities</a></span></dt><dt><span class="section"><a href="sect.apt-get.html#section.apt-mix-distros">6.2.6. Working with Several Distributions</a></span></dt></dl></dd><dt><span class="section"><a href="sect.apt-cache.html">6.3. The <code class="command">apt-cache</code> Command</a></span></dt><dt><span class="section"><a href="sect.apt-frontends.html">6.4. Frontends: <code class="command">aptitude</code>, <code class="command">synaptic</code></a></span></dt><dd><dl><dt><span class="section"><a href="sect.apt-frontends.html#aptitude">6.4.1.  <code class="command">aptitude</code> </a></span></dt><dt><span class="section"><a href="sect.apt-frontends.html#idp13123504">6.4.2.  <code class="command">synaptic</code> </a></span></dt></dl></dd><dt><span class="section"><a href="sect.package-authentication.html">6.5. Checking Package Authenticity</a></span></dt><dt><span class="section"><a href="sect.dist-upgrade.html">6.6. Upgrading from One Stable Distribution to the Next</a></span></dt><dd><dl><dt><span class="section"><a href="sect.dist-upgrade.html#idp13145440">6.6.1. Recommended Procedure</a></span></dt><dt><span class="section"><a href="sect.dist-upgrade.html#idp13166056">6.6.2. Handling Problems after an Upgrade</a></span></dt></dl></dd><dt><span class="section"><a href="sect.regular-upgrades.html">6.7. Keeping a System Up to Date</a></span></dt><dt><span class="section"><a href="sect.automatic-upgrades.html">6.8. Automatic Upgrades</a></span></dt><dd><dl><dt><span class="section"><a href="sect.automatic-upgrades.html#idp13194848">6.8.1. Configuring <code class="command">dpkg</code></a></span></dt><dt><span class="section"><a href="sect.automatic-upgrades.html#idp13197056">6.8.2. Configuring APT</a></span></dt><dt><span class="section"><a href="sect.automatic-upgrades.html#idp13198312">6.8.3. Configuring <code class="command">debconf</code></a></span></dt><dt><span class="section"><a href="sect.automatic-upgrades.html#idp13202952">6.8.4. Handling Command Line Interactions</a></span></dt><dt><span class="section"><a href="sect.automatic-upgrades.html#idp13205312">6.8.5. The Miracle Combination</a></span></dt></dl></dd><dt><span class="section"><a href="sect.searching-packages.html">6.9. Searching for Packages</a></span></dt></dl></div><div class="highlights"><div class="para"><p></p>
		What makes Debian so popular with administrators is how easily software can be installed and how easily the whole system can be updated. This unique advantage is largely due to the <span class="emphasis"><em>APT</em></span> program, the features of which Falcot Corp administrators studied with enthusiasm.
	</div></div><div class="para"><p></p>
		<a id="idp2586072" class="indexterm"></a>
		 <a id="idp5180408" class="indexterm"></a>
		 APT is the abbreviation for Advanced Package Tool. What makes this program “advanced” is its approach to packages. It doesn't simply evaluate them individually, but it considers them as a whole and produces the best possible combination of packages depending on what is available and compatible (according to dependencies).
	</div><div class="sidebar"><div class="titlepage"><div><div><h6><span class="emphasis"><em>VOCABULARY</em></span> Package source and source package</h6></div></div></div><div class="para"><p></p>
		The word <span class="emphasis"><em>source</em></span> can be ambiguous. A source package — a package containing the source code of a program — should not be confused with a package source — a repository (website, FTP server, CD-ROM, local directory, etc.) which contains packages.
	</div></div><div class="para"><p></p>
		APT needs to be given a “list of package sources”: the file <code class="filename">/etc/apt/sources.list</code> will list the different repositories (or “sources”) that publish Debian packages. APT will then import the list of packages published by each of these sources. This operation is achieved by downloading <code class="filename">Packages.gz</code> or <code class="filename">Packages.bz2</code> files (in case of a source of binary packages) and <code class="filename">Sources.gz</code> or <code class="filename">Sources.bz2</code> files (in case of a source of source packages) and by analyzing their contents. When an old copy of these files is already present, APT can update it by only downloading the differences (see sidebar <a class="xref" href="sect.apt-get.html#encadre.apt-pdiff"><span class="emphasis"><em>TIP</em></span> Incremental upgrade</a>).
	</div><a id="idp4553384" class="indexterm"></a><a id="idp10082752" class="indexterm"></a><div class="sidebar"><div class="titlepage"><div><div><h6><span class="emphasis"><em>BACK TO BASICS</em></span> <code class="command">gzip</code>, <code class="command">bzip2</code>, <code class="command">LZMA</code> and <code class="command">XZ</code> Compression</h6></div></div></div><a id="idp3865680" class="indexterm"></a><a id="idp3931152" class="indexterm"></a><a id="idp2740736" class="indexterm"></a><a id="idp6606104" class="indexterm"></a><div class="para"><p></p>
		A <code class="filename">.gz</code> extension refers to a file compressed with the <code class="command">gzip</code> utility. <code class="command">gzip</code> is the fast and efficient traditional Unix utility to compress files. Newer tools achieve better rates of compression but require more calculation time to compress a file. Among them, and by order of appearance, there are <code class="command">bzip2</code> (generating files with a <code class="filename">.bz2</code> extension), <code class="command">lzma</code> (generating <code class="filename">.lzma</code> files) and <code class="command">xz</code> (generating <code class="filename">.xz</code> files).
	</div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" id="sect.apt-sources.list">6.1. Filling in the <code class="filename">sources.list</code> File</h2></div></div></div><a id="idp6918672" class="indexterm"></a><a id="idp6919216" class="indexterm"></a><a id="idp6919680" class="indexterm"></a><a id="idp6920400" class="indexterm"></a><div class="para"><p></p>
			Each active line of the <code class="filename">/etc/apt/sources.list</code> file contains the description of a source, made of 3 parts separated by spaces.
		</div><div class="para"><p></p>
			The first field indicates the source type:
		</div><div class="itemizedlist"><ul><li class="listitem"><div class="para"><p></p>
					“<code class="literal">deb</code>” for binary packages,
				</div></li><li class="listitem"><div class="para"><p></p>
					“<code class="literal">deb-src</code>” for source packages.
				</div></li></ul></div><div class="para"><p></p>
			The second field gives the base URL of the source (combined with the filenames present in the <code class="filename">Packages.gz</code> files, it must give a full and valid URL): this can consist in a Debian mirror or in any other package archive set up by a third party. The URL can start with <code class="literal">file://</code> to indicate a local source installed in the system's file hierarchy, with <code class="literal">http://</code> to indicate a source accessible from a web server, or with <code class="literal">ftp://</code> for a source available on an FTP server. The URL can also start with <code class="literal">cdrom://</code> for CD-ROM based installations, although this is less frequent, since network-based installation methods are more and more common.
		</div><div class="para"><p></p>
			The syntax of the last field depends on whether the source corresponds to a Debian mirror or not. In the case of a Debian mirror, name the chosen distribution (<code class="literal">stable</code>, <code class="literal">testing</code>, <code class="literal">unstable</code> or their current code names — see the list in sidebar <a class="xref" href="sect.foundation-documents.html#cadre.bruce-perens"><span class="emphasis"><em>COMMUNITY</em></span> Bruce Perens, a controversial leader</a>), then the sections to enable (chosen between <code class="literal">main</code>, <code class="literal">contrib</code>, and <code class="literal">non-free</code>). In all other cases, simply indicate the subdirectory of the desired source (this is often a simple “<code class="filename">./</code>” which refers to the absence of a subdirectory — the packages are then directly at the specified URL).
		</div><div class="sidebar important"><a xmlns="" id="cadre-sections"></a><div class="titlepage"><div><div><h6><span class="emphasis"><em>VOCABULARY</em></span> The <span class="foreignphrase"><em class="foreignphrase">main</em></span>, <span class="foreignphrase"><em class="foreignphrase">contrib</em></span> and <span class="foreignphrase"><em class="foreignphrase">non-free</em></span> archives</h6></div></div></div><a id="idp4024976" class="indexterm"></a><a id="idp4025760" class="indexterm"></a><a id="idp4026384" class="indexterm"></a><a id="idp4027168" class="indexterm"></a><a id="idp4027792" class="indexterm"></a><a id="idp4028576" class="indexterm"></a><div class="para"><p></p>
			Debian uses three sections to differentiate packages according to the licenses chosen by the authors of each program. <span class="foreignphrase"><em class="foreignphrase">Main</em></span> (the main archive) gathers all packages which fully comply with the Debian Free Software Guidelines.
		</div><div class="para"><p></p>
			The <span class="foreignphrase"><em class="foreignphrase">non-free</em></span> archive is different because it contains software which does not (entirely) conform to these principles but which can nevertheless be distributed freely. This archive, which is not officially part of Debian, is a service for users who could need those softwares — however Debian always recommends giving priority to free software. The existence of this section represents a considerable problem for Richard M. Stallman and keeps the Free Software Foundation from recommending Debian to users.
		</div><div class="para"><p></p>
			<span class="foreignphrase"><em class="foreignphrase">Contrib</em></span> (contributions) is a stock of open source software which cannot function without some non-free elements. These elements can be software from the <span class="foreignphrase"><em class="foreignphrase">non-free</em></span> section, or non-free files such as game ROMs, BIOS of consoles, etc. <span class="foreignphrase"><em class="foreignphrase">Contrib</em></span> also includes free software whose compilation requires proprietary elements. This was initially the case for the OpenOffice.org office suite, which used to require a proprietary Java environment.
		</div></div><div class="para"><p></p>
			Generally, the contents of a standard <code class="filename">sources.list</code> file can be the following:
		</div><div class="example"><h6>Example 6.1. <code class="filename">/etc/apt/sources.list</code> file</h6><div class="example-contents"><pre class="programlisting"># Security updates
deb http://security.debian.org/ stable/updates main contrib non-free
deb-src http://security.debian.org/ stable/updates main contrib non-free

# Debian mirror
deb http://ftp.debian.org/debian stable main contrib non-free
deb-src http://ftp.debian.org/debian stable main contrib non-free
</pre></div></div><br class="example-break" /><div class="para"><p></p>
			This file lists all sources of packages associated with the stable version of Debian. If you would like to use <span class="distribution distribution">Testing</span> or <span class="distribution distribution">Unstable</span>, you will of course have to add (or replace them with) the appropriate lines. When the desired version of a package is available on several mirrors, the first one listed in the <code class="filename">sources.list</code> file will be used. For this reason, non-official sources are usually added at the end of the file.
		</div><div class="sidebar"><div class="titlepage"><div><div><h6><span class="emphasis"><em>TIP</em></span> <code class="filename">/etc/apt/sources.list.d/*.list</code> files</h6></div></div></div><div class="para"><p></p>
			If many package sources are referenced, it can be useful to split them in multiple files. Each part is then stored in <code class="filename">/etc/apt/sources.list.d/<em class="replaceable"><code>filename</code></em>.list</code> (see sidebar <a class="xref" href="sect.apt-get.html#cadre-repertoire.d"><span class="emphasis"><em>BACK TO BASICS</em></span> Directories ending in <code class="filename">.d</code></a>).
		</div></div><div class="sidebar"><div class="titlepage"><div><div><h6><span class="emphasis"><em>QUICK LOOK</em></span> <code class="command">apt-spy</code></h6></div></div></div><a id="idp12861936" class="indexterm"></a><div class="para"><p></p>
			This software tests the download speed from several Debian mirrors and generates a <code class="filename">sources.list</code> file which points to the the fastest mirror.
		</div><div class="para"><p></p>
			The mirror selected during installation is generally suitable since its selection is based on the country. However, if the download is a little slow, or after a move, you can try running the application available in the <span class="pkg pkg">apt-spy</span> package.
		</div></div><a id="idp12863880" class="indexterm"></a><div class="para"><p></p>
			The <code class="filename">sources.list</code> file contains several other entry types: some describe the Debian CD-ROMs you have. Contrary to other entries, a CD-ROM is not always available since it has to be inserted into the drive and since only one disc can be read at a time — consequently, these sources are managed in a slightly different way. These entries need to be added with the <code class="command">apt-cdrom</code> program, usually executed with the <code class="literal">add</code> parameter. The latter will then request the disc to be inserted in the drive and will browse its contents looking for <code class="filename">Packages</code> files. It will use these files to update its database of available packages (this is usually done by the <code class="command">aptitude update</code> command). From then on, APT can require the disc to be inserted if it needs one of its packages.
		</div><div class="section"><div class="titlepage"><div><div><h3 class="title" id="idp12866472">6.1.1. Other Available Official Repositories</h3></div></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title" id="section.proposed-updates">6.1.1.1. <span class="distribution distribution">Stable</span> Updates</h4></div></div></div><a id="idp12867576" class="indexterm"></a><div class="para"><p></p>
					Once published, the <span class="distribution distribution">Stable</span> distribution is only updated about once every 2 months in order to integrate the security updates published on <code class="literal">security.debian.org</code>.
				</div><div class="para"><p></p>
					This minor release can also include updates for packages that have to evolve over time... like <span class="pkg pkg">spamassassin</span>'s spam detection rules, <span class="pkg pkg">clamav</span>'s virus database, or the daylight-saving rules of all timezones (<span class="pkg pkg">tzdata</span>).
				</div><div class="para"><p></p>
					All those updates are prepared in a repository known as <code class="literal">proposed-updates</code>. Anyone can use this repository to test those updates before their official publication. The extract below uses the <code class="literal">squeeze-proposed-updates</code> alias which is both more explicit and more consistent since <code class="literal">lenny-proposed-updates</code> also exists (for the <span class="distribution distribution">Oldstable</span> updates):
				</div><pre class="programlisting">deb http://ftp.debian.org/debian squeeze-proposed-updates main contrib non-free
</pre><div class="para"><p></p>
					Once ready, the most important updates — those which cannot wait for the next minor Debian release — are published in the <code class="literal">stable-updates</code> repository (which most systems are expected to use):
				</div><pre class="programlisting">deb http://ftp.debian.org/debian stable-updates main contrib non-free
</pre></div><div class="section"><div class="titlepage"><div><div><h4 class="title" id="section.backports">6.1.1.2. The Backports From <code class="literal">backports.debian.org</code></h4></div></div></div><a id="idp3179896" class="indexterm"></a><a id="idp3180440" class="indexterm"></a><a id="idp3180920" class="indexterm"></a><div class="para"><p></p>
					Unsurprisingly, the <code class="literal">backports.debian.org</code> server hosts “package backports”. The term refers to a package of a recent software which has been recompiled for an older distribution, generally for <span class="distribution distribution">Stable</span>. When the distribution becomes a little dated, numerous software projects have released new versions that are not integrated into the current <span class="distribution distribution">Stable</span> (which is only modified to address the most critical problems, such as security problems). Since the <span class="distribution distribution">Testing</span> and <span class="distribution distribution">Unstable</span> distributions can be more risky, some volunteers sometimes offer recompilations of recent software applications for <span class="distribution distribution">Stable</span>, which has the advantage to limit potential instability to a small number of chosen packages. <div xmlns="" class="url">→ <a xmlns="http://www.w3.org/1999/xhtml" href="http://backports.debian.org/">http://backports.debian.org/</a></div>
				</div><div class="para"><p></p>
					The <code class="filename">sources.list</code> entry for backports targeting the <span class="distribution distribution">Squeeze</span> distribution is the following:
				</div><pre class="programlisting">deb http://backports.debian.org/debian-backports squeeze-backports main contrib non-free
</pre></div><div class="section"><div class="titlepage"><div><div><h4 class="title" id="idp3186032">6.1.1.3. The <span class="distribution distribution">Experimental</span> Repository</h4></div></div></div><a id="idp3186792" class="indexterm"></a><div class="para"><p></p>
					The archive of <span class="distribution distribution">Experimental</span> packages is present on all Debian mirrors, and contains packages which are not in the <span class="distribution distribution">Unstable</span> version yet because of their substandard quality — they are often software development versions or pre-versions (alpha, beta, release candidate…). A package can also be sent there after undergoing subsequent changes which can generate problems. The maintainer then tries to uncover them thanks to advanced users who can manage important issues. After this first stage, the package is moved into <span class="distribution distribution">Unstable</span>, where it reaches a much larger audience and where it will be tested in much more detail.
				</div><div class="para"><p></p>
					<span class="distribution distribution">Experimental</span> is generally used by users who do not mind breaking their system and then repairing it. This distribution gives the possibility to import a package which a user wants to try or use as the need arises. That is exactly how Debian approaches it, since adding it in APT's <code class="filename">sources.list</code> file does not lead to the systematic use of its packages. The line to be added is:
				</div><div class="informalexample"><pre class="programlisting">deb http://ftp.debian.org/debian experimental main contrib non-free
</pre></div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title" id="section.ressources-non-off">6.1.2. Non-Official Resources: <code class="literal">apt-get.org</code> and <code class="literal">mentors.debian.net</code></h3></div></div></div><a id="idp13271712" class="indexterm"></a><a id="idp13272272" class="indexterm"></a><div class="para"><p></p>
				There are numerous non-official sources of Debian packages set up by advanced users who have recompiled some softwares, by programmers who make their creation available to all, and even by Debian developers who offer pre-versions of their package online. A web site was set up to find these alternative sources more easily. It contains an impressive amount of Debian package sources which can immediately be integrated into <code class="filename">sources.list</code> files. However, be careful not to add random packages. Each source is designed for a particular version of Debian (the one used to compile the packages in question); each user should maintain a certain coherence in what they choose to install. <div xmlns="" class="url">→ <a xmlns="http://www.w3.org/1999/xhtml" href="http://www.apt-get.org/">http://www.apt-get.org/</a></div>
			</div><div class="para"><p></p>
				The <code class="literal">mentors.debian.net</code> site is also interesting, since it gathers packages created by candidates to the status of official Debian developer or by volunteers who wish to create Debian packages without going through that process of integration. These packages are made available without any guarantee regarding their quality; make sure that you check their origin and integrity and then test them before you consider using them in production.
			</div><div class="sidebar"><div class="titlepage"><div><div><h6><span class="emphasis"><em>COMMUNITY</em></span> The <code class="literal">debian.net</code> sites</h6></div></div></div><a id="idp13276016" class="indexterm"></a><div class="para"><p></p>
				The <span class="emphasis"><em>debian.net</em></span> domain is not an official resource of the Debian project. Each Debian developer may use that domain name for their own use. These websites can contain unofficial services (sometimes personal sites) hosted on a machine which does not belong to the project and set up by Debian developers, or even prototypes about to be moved on to <span class="emphasis"><em>debian.org</em></span>. Two reasons can explain why some of these prototypes remain on <span class="emphasis"><em>debian.net</em></span>: either no one has made the necessary effort to transform it into an official service (hosted on the <span class="emphasis"><em>debian.org</em></span> domain, and with a certain guarantee of maintenance), or the service is too controversial to be officialized.
			</div></div><div class="para"><p></p>
				Installing a package means giving root rights to its creator, because they decide on the contents of the initialization scripts which are run under that identity. Official Debian packages are created by volunteers who have been co-opted and reviewed and who can seal their packages so that their origin and integrity can be checked.
			</div><div class="para"><p></p>
				In general, be wary of a package whose origin you don't know and which isn't hosted on one of the official Debian servers: evaluate the degree to which you can trust the creator, and check the integrity of the package. <div xmlns="" class="url">→ <a xmlns="http://www.w3.org/1999/xhtml" href="http://mentors.debian.net/">http://mentors.debian.net/</a></div>
			</div><div class="sidebar"><a xmlns="" id="cadre.snapshot.debian.org"></a><div class="titlepage"><div><div><h6><span class="emphasis"><em>GOING FURTHER</em></span> Old package versions: <code class="literal">snapshot.debian.org</code></h6></div></div></div><a id="idp13280728" class="indexterm"></a><div class="para"><p></p>
				A new service (introduced in April 2010) can be used to “go backwards in time” and to find an old version of a package. It can be used for example to identify which version of a package introduced a regression, and more concretely, to come back to the former version while waiting for the regression fix.
			</div></div></div></div></div><div id="site_footer"></div><script type="text/javascript">
		$("#site_footer").load("../../../../../footer.html");
	</script><ul class="docnav"><li class="previous"><a accesskey="p" href="sect.coexistence-with-other-packaging-systems.html"><strong>Prev</strong>5.5. Coexistence with Other Packaging Systems</a></li><li class="up"><a accesskey="u" href="#"><strong>Up</strong></a></li><li class="home"><a accesskey="h" href="index.html"><strong>Home</strong></a></li><li class="next"><a accesskey="n" href="sect.apt-get.html"><strong>Next</strong>6.2. aptitude and apt-get Commands</a></li></ul></body></html>
