<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>6.8. Automatic Upgrades</title><link rel="stylesheet" type="text/css" href="Common_Content/css/default.css" /><link rel="stylesheet" media="print" href="Common_Content/css/print.css" type="text/css" /><meta name="generator" content="publican 3.0" /><meta name="package" content="Debian-debian-handbook-6.0-en-US-1.0-1" /><meta name="keywords" content="apt-get, apt-cache, aptitude, synaptic, sources.list, apt-cdrom" /><link rel="home" href="index.html" title="The Debian Administrator's Handbook" /><link rel="up" href="apt.html" title="Chapter 6. Maintenance and Updates: The APT Tools" /><link rel="prev" href="sect.regular-upgrades.html" title="6.7. Keeping a System Up to Date" /><link rel="next" href="sect.searching-packages.html" title="6.9. Searching for Packages" /></head><body><p class="hidden" id="title"><a class="left" href="http://www.debian.org"><img src="Common_Content/images/image_left.png" alt="Product Site" /></a><a class="right" href="http://debian-handbook.info"><img src="Common_Content/images/image_right.png" alt="Documentation Site" /></a></p><ul class="docnav"><li class="previous"><a accesskey="p" href="sect.regular-upgrades.html"><strong>Prev</strong></a></li><li class="home">The Debian Administrator's Handbook</li><li class="next"><a accesskey="n" href="sect.searching-packages.html"><strong>Next</strong></a></li></ul><div class="section"><div class="titlepage"><div><div><h2 class="title" id="sect.automatic-upgrades">6.8. Automatic Upgrades</h2></div></div></div><a id="idp13193688" class="indexterm"></a><div class="para"><p></p>
			Since Falcot Corp has many computers but only limited manpower, its administrators try to make upgrades as automatic as possible. The programs in charge of these processes must therefore run with no human intervention.
		</div><div class="section"><div class="titlepage"><div><div><h3 class="title" id="idp13194848">6.8.1. Configuring <code class="command">dpkg</code></h3></div></div></div><div class="para"><p></p>
				As we have already mentioned (see sidebar <a class="xref" href="sect.package-meta-information.html#cadre.questions-conffiles"><span class="emphasis"><em>GOING FURTHER</em></span> Avoiding the configuration file questions</a>), <code class="command">dpkg</code> can be instructed not to ask for confirmation when replacing a configuration file (with the <code class="literal">--force-confdef --force-confold</code> options). Interactions can, however, have three other sources: some come from APT itself, some are handled by <code class="command">debconf</code>, and some happen on the command line due to package configuration scripts.
			</div></div><div class="section"><div class="titlepage"><div><div><h3 class="title" id="idp13197056">6.8.2. Configuring APT</h3></div></div></div><div class="para"><p></p>
				The case of APT is simple: the <code class="literal">-y</code> option (or <code class="literal">--assume-yes</code>) tells APT to consider the answer to all its questions to be “yes”.
			</div></div><div class="section"><div class="titlepage"><div><div><h3 class="title" id="idp13198312">6.8.3. Configuring <code class="command">debconf</code></h3></div></div></div><div class="para"><p></p>
				The case of <code class="command">debconf</code> deserves more details. This program was, from its inception, designed to control the relevance and volume of questions displayed to the user, as well as the way they are shown. That is why its configuration requests a minimal priority for questions; only questions above the minimal priority are displayed. <code class="command">debconf</code> assumes the default answer (defined by the package maintainer) for questions which it decided to skip.
			</div><div class="para"><p></p>
				The other relevant configuration element is the interface used by the front-end. If you choose <code class="literal">noninteractive</code> out of the choices, all user interaction is disabled. If a package tries to display an informative note, it will be sent to the administrator by email.
			</div><div class="para"><p></p>
				To reconfigure <code class="command">debconf</code>, use the <code class="command">dpkg-reconfigure</code> tool from the <span class="pkg pkg">debconf</span> package; the relevant command is <code class="command">dpkg-reconfigure debconf</code>. Note that the configured values can be temporarily overridden with environment variables when needed (for instance, <code class="varname">DEBIAN_FRONTEND</code> controls the interface, as documented in the <span class="citerefentry"><span class="refentrytitle">debconf</span>(7)</span> manual page).
			</div></div><div class="section"><div class="titlepage"><div><div><h3 class="title" id="idp13202952">6.8.4. Handling Command Line Interactions</h3></div></div></div><div class="para"><p></p>
				The last source of interactions, and the hardest to get rid of, is the configuration scripts run by <code class="command">dpkg</code>. There is unfortunately no standard solution, and no answer is overwhelmingly better than another.
			</div><div class="para"><p></p>
				The common approach is to suppress the standard input by redirecting the empty content of <code class="filename">/dev/null</code> into it with <code class="command"><em class="replaceable"><code>command</code></em> &lt;/dev/null</code>, or to feed it with an endless stream of newlines. None of these methods are 100 % reliable, but they generally lead to the default answers being used, since most scripts consider a lack of reply as an acceptance of the default value.
			</div></div><div class="section"><div class="titlepage"><div><div><h3 class="title" id="idp13205312">6.8.5. The Miracle Combination</h3></div></div></div><div class="para"><p></p>
				By combining the previous elements, it is possible to design a small but rather reliable script which can handle automatic upgrades.
			</div><div class="example"><h6>Example 6.3. Non-interactive upgrade script</h6><div class="example-contents"><pre class="programlisting">export DEBIAN_FRONTEND=noninteractive
yes '' | apt-get -y -o Dpkg::Options::="--force-confdef" -o Dpkg::Options::="--force-confold" dist-upgrade
</pre></div></div><br class="example-break" /><div class="sidebar"><div class="titlepage"><div><div><h6><span class="emphasis"><em>IN PRACTICE</em></span> The Falcot Corp case</h6></div></div></div><div class="para"><p></p>
				Falcot computers are a heterogeneous system, with machines having various functions. Administrators will therefore pick the most relevant solution for each computer.
			</div><div class="para"><p></p>
				In practice, the servers running <span class="distribution distribution">Squeeze</span> are configured with the “miracle combination” above, and are kept up to date automatically. Only the most critical servers (the firewalls, for instances) are set up with <code class="command">apticron</code>, so that upgrades always happen under the supervision of an administrator.
			</div><div class="para"><p></p>
				The office workstations in the administrative services also run <span class="distribution distribution">Squeeze</span>, but they are configured with the <code class="command">update-notifier</code>/<code class="command">update-manager</code> combination, so that users trigger the upgrades themselves. The rationale for this decision is that if upgrades happen without an explicit action, the behavior of the computer might change unexpectedly, which could cause confusion for the main users.
			</div><div class="para"><p></p>
				In the lab, the few computers using <span class="distribution distribution">Testing</span> — to take advantage of the latest software versions — are not upgraded automatically either. Administrators only configure APT to prepare the upgrades but not enact them; when they decide to upgrade (manually), the tedious parts of refreshing package lists and downloading packages will be avoided, and administrators can focus on the really useful part.
			</div></div></div></div><div id="site_footer"></div><script type="text/javascript">
		$("#site_footer").load("../../../../../footer.html");
	</script><ul class="docnav"><li class="previous"><a accesskey="p" href="sect.regular-upgrades.html"><strong>Prev</strong>6.7. Keeping a System Up to Date</a></li><li class="up"><a accesskey="u" href="#"><strong>Up</strong></a></li><li class="home"><a accesskey="h" href="index.html"><strong>Home</strong></a></li><li class="next"><a accesskey="n" href="sect.searching-packages.html"><strong>Next</strong>6.9. Searching for Packages</a></li></ul></body></html>
